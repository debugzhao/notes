### 	基本存储概念

1. spdk

2. raft协议

3. paxios协议

4. bdev

5. 磁盘序列号和pcie区别

6. chunk server和resource manager区别

7. 虚拟化技术

8. NVMe

   

9. PCI总线

   PCI即Peripheral Component Interconnect，中文意思是“外围器件互联”，是由PCISIG (PCI Special Interest Group)推出的一种局部并行总线标准

10. SCSI总线

    把磁盘和磁带设备连接到应用服务器或文件服务器，最常用的方法就是通过传统的SCSI总线实现。尽管 SCSI主要是一个块协议，但这个术语也被用来指称运行该协议的并行线缆机制

11. RDMA网卡

### 存储类型区别

这三者的本质差别是使用数据的“用户”不同：块存储的用户是可以读写块设备的软件系统，例如传统的[文件系统](https://www.zhihu.com/search?q=文件系统&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"answer"%2C"sourceId"%3A1159036357})、数据库；文件存储的用户是自然人；对象存储的用户则是其它[计算机软件](https://www.zhihu.com/search?q=计算机软件&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"answer"%2C"sourceId"%3A1159036357})。

1. 文件存储

   把存储介质上的数据组织成目录-子目录-文件这种形式的数据结构，用于从这个结构中寻找、添加、修改、删除文件的程序，以及用于维护这个结构的程序，组成的系统有一个专用的名字：**文件系统（File System）**。文件系统有很多，常见的有Windows的FAT/FAT32/NTFS，Linux的EXT2/EXT3/EXT4/XFS/BtrFS等。

   而在网络存储中，底层数据并非存储在本地的存储介质，而是另外一台服务器上，不同的客户端都可以用类似文件系统的方式访问这台服务器上的文件，这样的系统叫**[网络文件系统](https://www.zhihu.com/search?q=网络文件系统&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"answer"%2C"sourceId"%3A1159036357})（Network File System）**

2. 块存储

   硬盘也叫做块设备，为了方便管理，硬盘这样的块设备可以划分成多个逻辑块设备，也就是我们熟悉的硬盘分区。

   反过来单个存储介质的容量、性能有限，可以通过某种技术手段将多个物理块设备组合成一个逻辑块设备。例如RAID、JBOD、卷管理系统、Windows的动态磁盘、Linux的LVM。

   在网络存储中，服务器把本地的一个逻辑块设备——底层可能是一个物理块设备的一部分，也可能是多个物理块设备的组合，又或者多个物理块设备的组合中的一部分，甚至是一个本地文件系统上的一个文件——通过某种协议模拟成一个块设备，远程的客户端使用相同的协议把这个逻辑块设备作为一个本地存储介质来使用，划分分区，格式化自己的文件系统等等。这就是块存储，比较常见的块存储协议是iSCSI。

3. 对象存储

   对象存储其实介于块存储和文件存储之间。文件存储的[树状结构](https://www.zhihu.com/search?q=树状结构&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"answer"%2C"sourceId"%3A1159036357})以及路径访问方式虽然方便人类理解、记忆和访问，但计算机需要把路径进行分解，然后逐级向下查找，最后才能查找到需要的文件，对于应用程序来说既没必要，也很浪费性能。

   而块存储是排它的，服务器上的某个逻辑块被一台客户端挂载后，其它客户端就无法访问上面的数据了。对块设备的访问方式虽然比文件存储快，其实也很麻烦——一个文件往往是由多个块组成，并且很可能是不连续的。

   为了解决这中麻烦，使用一个统一的底层存储系统，管理这些文件和底层介质的组织结构，然后给每个文件一个唯一的标识，其它系统需要访问某个文件，直接提供文件的标识就可以了。存储系统可以用更高效的数据组织方式来管理这些**标识**以及**其对应的存储介质上的块**。

   当然，对于不同的软件系统来说，一次访问需要获取的不一定是单个我们传统意义上的文件，根据不同的需要可能只是一个文件的一部分，也可能是多个文件的组合，甚至是某个块设备，统称为对象。这就是对象存储。

### 开源存储系统区别

1. ceph
2. curve

### RPC协议和HTTP协议区别

### 存储知识科普

#### 硬件层介绍

##### 硬盘组合

在实际生产环境中，单个磁盘能提供的容量和性能还是有限，我们就需要利用一些组合技术将多个磁盘组合起来提供更好的服务。最基本的组合技术*RAID系列技术*；然后，我们在看一下更大规模的集成技术*SAN*和*NAS*。

#### 单机存储引擎介绍

#### 分布式存储系统解决方案

##### 数据如何分布

衡量一个数据分布算法好不好的标准就是看它是否分布的足够均匀，使得所有机器的负载方差足够小。

##### 如何容灾

分布式系统一个很重要的定位是要程序自动管理机器，尽量减少人工的参与

1. 机器宕机

   一个分布式系统必须保证一台机器的宕机对服务不受影响，并且在修复好了之后再重新放到集群当中之后也能正常工作。

2. 网络故障

   这是最常见且要命的故障，该问题会大大增加分布式系统设计的难度。故障一般发生在网络拥塞，路由变动，设备异常等情况。出现的问题可能是丢包，可能是延时，也可能是完全失去连接。

   有鉴于此，我们一般在设计分布式系统的时候，四层协议都采用TCP，很少采用UDP/UDT协议。而且由于TCP协议并不能完全保证数据传输到对面。

3. 其他异常

   比如磁盘坏块，但是机器并没有宕机；机器还活着，就是各种操作特别慢；

##### 读写过程一致性如何保证

在分布式系统中，为了容灾，一份数据肯定有多个副本，那么如何更新这多个副本以及控制读写协议就成了一个大问题。

##### 如何提高性能

分布式系统设计之初就是为了通过堆积机器来增加系统整体性能，所以系统性能也非常重要。性能部分一般会受一致性/容灾等设计的影响，会有一定的折衷。

衡量一个分布式系统的性能指标往往有：最大容量、读QPS、写QPS

##### 如何保证横向扩展

横向扩展是指一个集群的服务能力是否可以通过加机器做到线性扩展。

### [NVMe简介](https://zhuanlan.zhihu.com/p/71932170)

NVMe的全称是Non-Volatile Memory Express，如果翻译过来就是**非易失性内存主机控制器接口。规范用于定义硬件接口和传输协议。**

#### 存储概念

##### 尺寸外形

也就是设备的形状和大小，通常存储设备的尺寸外形包括如下

1. 2.5寸或者3.5寸驱动器
2. M.2 和 PCI Express（PCIe）

##### 接口

通过接口可以实现设备和计算机的通信，常见的存储设备接口如下：

1. SATA接口
2. PCIe接口
3. SAS接口、FC接口

##### 协议

协议规定了设备和计算机之间通信规范，常见的协议如下：

1. 用于SATA接的AHCI协议或者ATA协议
2. 用于PCIe接口的NVMe协议

**通过了解以上存储概念我们知道了NVMe是运行在某种接口上的通信协议，用于规范计算机和存储设备之间的数据传输。**

#### 为什么NVMe会这么快

由于SSD本上的物理特性，其数据访问速度已经相当快了，性能瓶颈出现在计算机与存储设备的接口和协议上。

NVMe协议本质上是建立了多个计算机与存储设备之间的通路，这样传输数据的效率机会快很多。在NVMe协议中，多个通路其实就是多个队列。NVMe协议可以最多有64K个队列，每个CPU或者核心都可以有一个队列，这样并发程度大大提升，性能也自然更高了。

### RDMA网卡简介

