# JVM内存结构

<img src="https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image.1nlxuxgf8lds.png" alt="image" style="zoom: 50%;" />

#### 1.程序计数器

程序计数器：program counter register

Java源代码由JVM编译成**二进制字节码指令**，这些二进制字节码指令最终经过**解释器编译成CPU可以直接执行的机器码**

##### 1.1作用

**程序计数器负责记录下一条JVM指令的执行地址**

##### 1.2特点

1. 是线程私有的

   在多线程环境下，线程1的时间片用完之后需要保存当前线程的下一条JVM指令的执行地址，用以线程1抢占到CPU资源时继续从上次程序被阻塞状态的位置（从程序计数器中读取下一条JVM指令地址）继续运行。因此程序计数器必须设计成线程私有的

2. 不会存在内存溢出情况

```java
0: getstatic #20 // PrintStream out = System.out;
3: astore_1 // --
4: aload_1 // out.println(1);
5: iconst_1 // --
6: invokevirtual #26 // --
9: aload_1 // out.println(2);
10: iconst_2 // --
11: invokevirtual #26 // --
14: aload_1 // out.println(3);
15: iconst_3 // --
16: invokevirtual #26 // --
19: aload_1 // out.println(4);
20: iconst_4 // --
21: invokevirtual #26 // --
24: aload_1 // out.println(5);
25: iconst_5 // --
26: invokevirtual #26 // --
29: return
```

#### 2.虚拟机栈

##### 2.1定义

栈：每个线程运行时需要的内存

栈帧：每个方法运行时需要的内存（方法参数、局部变量、返回地址都会用到内存）

栈是先进后出的数据结构。线程运行时需要用到虚拟机栈，每创建一个线程就会开辟一块栈内存。每个栈由多个栈帧组成，一个栈帧对应着一次方法的调用

栈和栈帧对应的关系：每次调用一个方法会给这个方法划分一块栈帧空间，并且压入栈内；方法执行结束这个栈帧出栈并且释放栈帧对应的内存空间

##### 2.2栈内存溢出

##### 2.3线程运行诊断



#### 3.本地方法栈

#### 4.堆

#### 5.方法区

