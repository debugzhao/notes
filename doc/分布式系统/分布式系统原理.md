# 分布式系统原理介绍

## 2 分布式系统原理介绍

### 2.1 数据分布方式

#### 2.1.1 哈希方式

Hash方式最常见的数据分布方式，其方法是按照数据的某一特征值计算数据的哈希值，并将哈希值与机器简历映射关系，从而将不同的哈希值的数据分不到不同机器上。

![image](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image.3abv495q5kw0.webp)

可以将哈希方式看成一个大的哈希表，每组机器被看做哈希表中的一个桶，数据根据哈希值被分布到不同的桶上。

**哈希方式优点：**

只要哈希函数的散列性特别好，数据可以均匀地分布到集群中去。并且哈希方式记录的元数据信息也非常简单，只要知道数据的哈希值以及集群中节点的个数，就可以计算出数据分布的位置。

**哈希方式缺点：**

1. 可扩展性不高

   一旦集群规模需要扩展，则几乎所有的数据需要迁移并重新分布。

   针对哈希方式可扩展性查的问题，一种思路是不再将哈希值与机器数量做取模运算，而是将对应的映射关系作为元数据由专门的元数据服务器管理。

   访问数据时首先根据哈希值并查询元数据服务器，然后根据元数据获取对应的数据。这种方式可以使扩容成本不再随着机器数量的增长而增长，但是都需要以复杂的机制维护大量的元数据。

2. 容易出现数据倾斜（data skew）

   哈希方式另外一个缺点是一旦某数据特征值严重不均匀时，容易出现`数据倾斜`的问题。

#### 2.1.2 按照数据范围分布

#### 2.1.3 按照数据量分布

#### 2.1.4 一致性哈希

#### 2.1.5 副本与数据分布

#### 2.1.6 本地化计	算

#### 2.1.7 数据分布方式的选择

#### 2.1.8 工程投影

### 2.2 基本副本协议

### 2.3 Lease机制

### 2.4 Quorum机制

### 2.5 日志机制

### 2.6 两阶段提交协议

### 2.7 基于MVCC的分布式事务

### 2.8 Paxos协议

### 2.9 CAP理论

