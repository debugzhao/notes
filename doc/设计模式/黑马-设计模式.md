## 1.设计模式概述

### 1.3学习设计模式的必要性

设计模式的本质是面向对象设计原则的实际应用，是对类的封装性、继承性、多态性以及类关联关系、组合关系的充分理解

正确使用设计模式具有以下优点：

1. 可以提高研发的思维能力、编程能力和设计能力
2. 使程序设计更加标准化、代码实现更加工程化，从而大大提高开发的工作效率，缩短软件的开发周期
3. 使设计的代码可重用性更高、可读性更强、可维护性更高

### 1.4设计模式分类

1. 创建型模式

   创建型模式用于*描述怎样创建对象*，他的主要特点是**将对象的创建与使用分离/解耦**。GOF书中提到了单例、原型、工厂方法、抽象工厂、建造者等5中创建型模式

2. 结构型模式

   结构型模式用于描述**如何将类或者对象按照某种布局组成更大的结构**。GOF书中提到了代理、适配器、桥接、装饰、外观、享元、组合等7中结构型模式

3. 行为型模式

   行为型模式用于描述**类或者对象之间怎么相互协作共同完成单个对象无法完成的任务**，**以及怎么分配职责**

## 2.UML类图

#### 2.1关联关系

关联关系是对象之间的一种引用关系，用于表示一类对象与另一类对象之前的联系。（老师与学生、丈夫与妻子）关联关系分为：一般关联关系、聚合关系、组合关系

1. 单项关联

   ![image](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image.2e9rmyigf1jw.png)

   在UML类图中单向关联用一个带箭头的实线表示。上图表示每个顾客都有一个地址，这通过让Customer类持有一个类型为Address的成员变量类实现。

2. 双向关联

   ![image](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image.42tnucgg2600.png)

   从上图中我们很容易看出，所谓的双向关联就是双方各自持有对方类型的成员变量。

3. 自关联

   ![image](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image.4vlzuqylmbg0.png)

   自关联在UML类图中用一个带有箭头且指向自身的线表示。上图的意思就是Node类包含类型为Node的成员变量，也就是“自己包含自己”。

#### 2.2聚合关系

聚合关系是关联关系的一种，是强关联关系，是整体和部分之间的关系。

聚合关系也是通过成员对象来实现的，其中成员对象是整体对象的一部分，但是成员对象可以脱离整体对象而独立存在。例如，学校与老师的关系，学校包含老师，但如果学校停办了，老师依然存在。

在 UML 类图中，聚合关系可以用带空心菱形的实线来表示，菱形指向整体。

![image-20191229173422328](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image-20191229173422328.78005m76yhc0.png)

#### 2.3组合关系

组合表示类之间的整体与部分的关系，但它是一种更强烈的聚合关系。

在组合关系中，整体对象可以控制部分对象的生命周期，一旦整体对象不存在，部分对象也将不存在，部分对象不能脱离整体对象而存在。例如，头和嘴的关系，没有了头，嘴也就不存在了。

在 UML 类图中，组合关系用带实心菱形的实线来表示，菱形指向整体。下图所示是头和嘴的关系图：

![image-20191229173455149](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image-20191229173455149.33i72tedzmq0.png)

#### 2.4依赖关系

依赖关系是一种使用关系，它是对象之间耦合度最弱的一种关联方式，是临时性的关联。在代码中某个类的方法通过局部变量、方法的参数、或者静态方法来访问另一个类中的方法来完成某些职责。

在 UML 类图中，依赖关系使用带箭头的虚线来表示，箭头从使用类指向被依赖的类。

![image-20191229173518926](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image-20191229173518926.2hpsz4re5gu.png)

#### 2.5继承关系

继承关系是对象之间耦合度最大的一种关系，表示一般与特殊的关系，是父类与子类之间的关系，是一种继承关系。

在 UML 类图中，泛化关系用带空心三角箭头的实线来表示，箭头从子类指向父类。

![image-20191229173539838](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image-20191229173539838.5ippyx93z1w0.png)

#### 2.6实现关系

实现关系是接口与实现类之间的关系。在这种关系中，类实现了接口，类中的操作实现了接口中所声明的所有的抽象操作。

在 UML 类图中，实现关系使用带空心三角箭头的虚线来表示

![image-20191229173554296](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/image-20191229173554296.7i1grjdvxwc0.png)

## 3.软件设计原则

在软件开发中，为了提高软件系统的可维护性、可复用性、可扩展性、灵活性。开发者要尽量根据一下6条原则来开发程序，从而提高软件的研发效率

#### 3.1开闭原则

**对扩展开放，对修改关闭。** 即在程序需要进行扩展的地方， 不能去修改原有的代码，实现热插拔的效果。要想实现这样的效果，我们需要用到接口和抽象类，因为抽象灵活性好，适用性广，只要抽象的合理，基本可以保证软件架构的运行，而软件中易变的细节可以抽象类的派生类中实现，当需求发生变化时，只需要重新派生一个派生类即可实现功能的扩展。

【示例】搜狗输入法皮肤切换设计

 分析：用户可以根据自己的喜爱更换自己的输入法的皮肤，也可以从网上下载新的皮肤。这些皮肤有共同的特点，可以为其定义一个抽象类（AbstractSkin），而每个具体的皮肤（DefaultSpecificSkin和HeimaSpecificSkin）是其子类。用户窗体可以根据需要选择或者增加新的主题，而不需要修改原代码，所以它是满足开闭原则的。

![open-close](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/open-close.3jieoqc7yww0.png)

#### 3.2里氏替换原则

子类可以扩展父类的功能，但不能改变父类原有的功能

#### 3.3依赖倒转原则

高层模块不应该依赖底层模块，两者都应该依赖其抽象；抽象不应该依赖细节，细节应该依赖其抽象。说人话就是**应该面向抽象/接口编程，而不应该面向实现编程**。这样就可以降低客户端和实现之间的耦合度。

下面看一个例子来理解依赖倒转原则

【例】组装电脑

现要组装一台电脑，需要配件cpu，硬盘，内存条。只有这些配置都有了，计算机才能正常的运行。选择cpu有很多选择，如Intel，AMD等，硬盘可以选择希捷，西数等，内存条可以选择金士顿，海盗船等。

![依赖倒转原则](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/依赖倒转原则.1covehzdbv28.png)

上面代码可以看到已经组装了一台电脑，但是似乎组装的电脑的cpu只能是Intel的，内存条只能是金士顿的，硬盘只能是希捷的，这对用户肯定是不友好的，用户有了机箱肯定是想按照自己的喜好，选择自己喜欢的配件。

根据依赖倒转原则进行改进：

我们需要修改compute类，让computer类依赖抽象（各个组件的接口），而不应该依赖各个组件的具体实现类

![依赖倒转原则改进](https://cdn.jsdelivr.net/gh/Andre235/-community@master/src/依赖倒转原则改进.67b7hszte3k0.png)

#### 3.4接口隔离原则

#### 3.5迪米特原则

#### 3.6合成复用原则